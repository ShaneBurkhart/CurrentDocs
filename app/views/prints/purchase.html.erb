<%= form_tag api_charge_path do %>
  <script src="https://checkout.stripe.com/v2/checkout.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js"></script>
  <button id="StripeChargeButton" class="btn_class">Purchase Prints</button>
  <% @plans.each do |plan| %>
    <label> <%= plan.name %>
    <input type="checkbox" value="<%= plan.id %>">
  </label>
  <% end %>
  <script>
    $('#StripeChargeButton').click(function(){
      var token = function(res){
        var $input = $('<input type=hidden name=stripeToken />').val(res.id);
        $('form').append($input).submit();
      };

      StripeCheckout.open({
        key:         "<%= Rails.configuration.stripe[:publishable_key] %>",
        amount:      5000,
        currency:    'usd',
        name:        "Contact <%= 'TODO put something here' %>",
        description: "Get a full refund by contacting us if you don't hire him/her! Terms and conditions apply.",
        panelLabel:  'Submit payment for',
        token:       token
      });

      return false;
    });
  </script>
<% end %>
